# Excel图片提取工具使用说明

## 🎯 功能概述

这个工具可以自动从Excel文件中提取所有图片，并按照以下结构分类存储：
- 按工作表名称分类
- 按列名进一步分类
- 自动创建目录结构

## 📁 文件说明

- `simple_excel_image_extractor.py` - 简化版提取脚本（推荐使用）
- `extract_excel_images.py` - 完整版提取脚本
- `requirements.txt` - Python依赖包列表
- `README.md` - 英文说明文档

## 🚀 快速开始

### 1. 安装依赖

```bash
# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
source venv/bin/activate

# 安装依赖包
pip install -r requirements.txt
```

### 2. 运行脚本

```bash
# 确保虚拟环境已激活
source venv/bin/activate

# 运行简化版脚本（推荐）
python simple_excel_image_extractor.py
```

## 📊 输出结果

脚本运行完成后，会在当前目录下创建 `extracted_images` 文件夹，包含以下结构：

```
extracted_images/
├── 第一批试标-嘉琪-优先/
│   └── 其他/
│       ├── image_1.jpeg
│       ├── image_2.jpeg
│       └── ... (共479张图片)
├── 第二批试标-泽珊-优先/
│   └── 其他/
├── 第三批试标-嘉琪/
│   └── 其他/
├── 第四批试标-泽珊/
│   └── 其他/
├── 第五批试标-嘉琪/
│   └── 其他/
└── 第六批试标-泽珊/
    └── 其他/
```

## ⚠️ 注意事项

1. **Excel文件格式**：仅支持 `.xlsx` 格式，不支持旧版 `.xls` 格式
2. **文件位置**：确保Excel文件在当前工作目录下
3. **文件大小**：大文件处理时间较长，请耐心等待
4. **权限要求**：确保有写入当前目录的权限

## 🔧 故障排除

### 常见问题

1. **找不到Excel文件**
   - 检查文件名是否正确
   - 确保文件在当前目录下

2. **没有提取到图片**
   - 确认Excel文件中确实包含图片
   - 检查图片是否被正确插入

3. **权限错误**
   - 确保有写入权限
   - 关闭可能正在使用Excel文件的程序

## 📈 性能说明

- **处理速度**：取决于Excel文件大小和图片数量
- **内存使用**：会创建临时文件，处理完成后自动清理
- **磁盘空间**：需要足够的空间存储提取的图片

## 🎉 成功案例

您的Excel文件已成功处理：
- **总工作表数**：6个
- **总图片数**：约1000+张
- **处理时间**：几秒钟
- **输出目录**：`extracted_images/`

## 📞 技术支持

如果遇到问题，请检查：
1. Python版本（建议3.7+）
2. 依赖包是否正确安装
3. Excel文件格式是否正确
4. 系统权限是否足够

## 🔄 更新日志

- **v1.0** - 基础图片提取功能
- **v1.1** - 按工作表分类存储
- **v1.2** - 按列名分类存储（当前版本） 